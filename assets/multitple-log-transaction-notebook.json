{"version":"5","defaultTimeframe":{"from":"now()-1h","to":"now()"},"sections":[{"id":"e12d493a-fda4-44f3-906f-44e508e52f01","type":"dql","showTitle":false,"drilldownPath":[],"title":"Find logs from specific source","state":{"input":{"value":"fetch logs\n| filter matchesValue(log.source, \"/var/log/multilog/*\")","timeframe":{"from":"now-2h","to":"now"}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}},"honeycomb":{"shape":"hexagon","legend":"auto"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}}},{"id":"b83b9453-9068-4877-ae8d-8c5bdfc53fb7","type":"dql","title":"find records with all transaction ids","showTitle":false,"drilldownPath":[],"state":{"input":{"value":"fetch logs\n| filter contains(content, \"DYNATRANSACTION\")\n| sort timestamp asc","timeframe":{"from":"now-2h","to":"now"}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}},"honeycomb":{"shape":"hexagon","legend":"auto"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}}},{"id":"e226d890-7a5b-4d63-87ed-d4b68db92911","type":"dql","showTitle":false,"drilldownPath":[],"title":"find specific transaction id","state":{"input":{"value":"fetch logs\n| filter contains(content, \"20240626DYNATRANSACTION20414\")\n| sort timestamp asc","timeframe":{"from":"now()-24h","to":"now()"}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}},"honeycomb":{"shape":"hexagon","legend":"auto"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}}},{"id":"2ce27f37-fca1-40a6-9bb8-37585658f186","type":"dql","title":"XML Capture","showTitle":false,"drilldownPath":[],"state":{"input":{"value":"fetch logs \n| filter matchesValue(log.file.path, \"/var/log/multilog/processor-01.log\")\n//| parse content, pattern:\"LD '<transactionid>'LD:transactionID'</transactionid>'\"\n//| fields timestamp, transactionID, log.file.name","timeframe":{"from":"now-2h","to":"now"}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}},"honeycomb":{"shape":"hexagon","legend":"auto"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}}},{"id":"f2236e92-74b2-4393-b322-7ee22115ea1c","type":"dql","title":"JSON Capture","showTitle":false,"drilldownPath":[],"state":{"input":{"value":"fetch logs \n| filter matchesValue(log.file.path, \"/var/log/multilog/processor-02.log\")\n//| parse content, \"JSON:json\"\n//| fieldsAdd transactionID = json[transactionid], customMessage = json[message]\n//| fields timestamp, transactionID, log.file.name","timeframe":{"from":"now()-24h","to":"now()"}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}},"honeycomb":{"shape":"hexagon","legend":"auto"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}}},{"id":"865bc06f-5ab5-4a09-b226-2758ee8582c4","type":"dql","title":"Plain text capture","showTitle":false,"drilldownPath":[],"showInput":true,"state":{"input":{"value":"fetch logs \n| filter matchesValue(log.file.path, \"/var/log/multilog/processor-03.log\")\n| parse content, pattern:\"LD ',valid,'LD:transactionID','\"\n| fields timestamp, transactionID, log.file.name","timeframe":{"from":"now()-24h","to":"now()"}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}},"honeycomb":{"shape":"hexagon","legend":"auto"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}}},{"id":"a02a4472-fbf2-4f5c-896e-9fe62ff670aa","type":"markdown","markdown":"#### So we've got 3 of 6 records captured, but what happens when we try to aggregate into single variable ? "},{"id":"efc8dc87-20c5-47fe-b2fa-4414be0baec9","type":"dql","title":"DQL works via an oder of operations, re-setting the same variable \"transactionID\" won't provide the desired results","showTitle":false,"drilldownPath":[],"state":{"input":{"value":"fetch logs\n| filter matchesValue(log.source, \"/var/log/multilog/*\")\n| parse content, pattern:\"LD '<transactionid>'LD:transactionID'</transactionid>'\"\n| parse content, \"JSON:json\"\n| fieldsAdd transactionID = json[transactionid], customMessage = json[message]\n| parse content, pattern:\"LD ',valid,'LD:transactionID','\"\n| fields timestamp, transactionID, log.file.name","timeframe":{"from":"now()-24h","to":"now()"}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}},"honeycomb":{"shape":"hexagon","legend":"auto"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}}},{"id":"df7629af-0a53-44bd-812c-8d36e90c8644","type":"markdown","markdown":"#### To prevent the overwriting, we can set a conditional variable for each capture record. One option is to do that through an if/else mechanism to check if the variable has been set, if not it will iterate through until it returns a result or comes back null: "},{"id":"60f4294a-6992-4c39-a49b-076a0fb0e6de","type":"dql","showTitle":false,"drilldownPath":[],"title":"Conditional Variables","state":{"input":{"value":"fetch logs\n| filter matchesValue(log.source, \"/var/log/multilog/*\")\n| parse content, pattern:\"LD '<transactionid>'LD:transactionID01'</transactionid>'\"\n| parse content, \"JSON:json\"\n| fieldsAdd transactionID02 = json[transactionid]\n| parse content, pattern:\"LD ',valid,'LD:transactionID03','\"\n| parse content, pattern:\"LD 'internalizedTracking#:'LD:transactionID04','\"\n| parse content, pattern:\"LD '>PMW-'LD:transactionID05'</operation>'\"\n| fieldsAdd transactionID = if(isNotNull(transactionID01), transactionID01, else:if(isNotNull(transactionID02), transactionID02, else: if(isNotNull(transactionID03), transactionID03)))\n| fields timestamp, transactionID, log.file.name","timeframe":{"from":"now()-24h","to":"now()"}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}},"honeycomb":{"shape":"hexagon","legend":"auto"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}}},{"id":"d94382c3-c2ab-42e6-af27-4da04a2f575c","type":"markdown","markdown":"#### What about nested json?\nhops 4 & 5 are very similar to pull data from, we can use the same type LD parse strings to pull out the values.\n\nHowever looking at the logs for hop #6\n\n\nlog record 2 has the needed transaction id in the top level json object\n```json\n{\n  \"timestamp\": \"2024-06-27 20:09:02.289\",\n  \"level\": \"info\",\n  \"appVersion\": \"1.22.0\",\n  \"message\": \"Hey there!\",\n  \"logLogger\": \"fake.cron.job\",\n  \"transactionid\": \"20240627DYNATRANSACTION9158\",\n  \"logType\": \"transactional record of 20240627DYNATRANSACTION9158\",\n  \"hopMessage\": \"hop 2\",\n  \"processorNumber\": \"processor2\",\n  \"metadata\": {\n    \"purpleMonkeyDishwasherId\": \"eDC0yqo0fp2tg7V\",\n    \"transactionlocation\": \"processor2\",\n    \"device02external\": \"2024-06-27 20:09:02.289z\",\n    \"orininationtimestamp\": \"2024-06-27 20:09:01.978\"\n  }\n}\n```\nlog record 6 has the needed transaction ID nested under \"metadata\" json object. How do we acceess it? \n```json\n{\n  \"timestamp\": \"2024-06-27 20:09:04.233\",\n  \"level\": \"info\",\n  \"appVersion\": \"0.1.0\",\n  \"message\": \"the final step!\",\n  \"purpleMonkeyDishwasherId\": \"eDC0yqo0fp2tg7V\",\n  \"logLogger\": \"totally.nota.cronjob\",\n  \"logType\": \"the most important transaction record\",\n  \"hopMessage\": \"hop #6\",\n  \"processorNumber\": \"processor 6\",\n  \"metadata\": {\n    \"originialTransactionId\": \"20240627DYNATRANSACTION9158\",\n    \"transactionlocation\": \"processor6\",\n    \"orininationtimestamp\": \"2024-06-27 20:09:04.233\"\n  }\n}\n```"},{"id":"1ebb1339-e929-4d62-ab64-47cfba195d84","type":"dql","showTitle":false,"drilldownPath":[],"title":"Capturing top level json compared to nested json","state":{"input":{"value":"fetch logs\n| filter matchesValue(log.source, \"/var/log/multilog/*\")\n//| parse content, pattern:\"LD '<transactionid>'LD:transactionID01'</transactionid>'\"\n| parse content, \"JSON:json\"\n| fieldsAdd transactionID02 = json[transactionid]\n//| parse content, pattern:\"LD ',valid,'LD:transactionID03','\"\n//| parse content, pattern:\"LD 'internalizedTracking#:'LD:transactionID04','\"\n//| parse content, pattern:\"LD '>PMW-'LD:transactionID05'</operation>'\"\n| fieldsAdd transactionID06 = json[metadata][originialTransactionId]\n| fields timestamp, transactionID02, transactionID06\n","timeframe":{"from":"now()-24h","to":"now()"}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}},"honeycomb":{"shape":"hexagon","legend":"auto"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}}},{"id":"eb77a316-a0b7-4ac1-9a74-575bc545a562","type":"dql","title":"Extract & Merge All Transaction IDs!","showTitle":false,"drilldownPath":[],"state":{"input":{"value":"fetch logs\n| filter matchesValue(log.source, \"/var/log/multilog/*\")\n| parse content, pattern:\"LD '<transactionid>'LD:transactionID01'</transactionid>'\"\n| parse content, \"JSON:json\"\n| fieldsAdd transactionID02 = json[transactionid]\n| parse content, pattern:\"LD ',valid,'LD:transactionID03','\"\n| parse content, pattern:\"LD 'internalizedTracking#:'LD:transactionID04','\"\n| parse content, pattern:\"LD '>PMW-'LD:transactionID05'</operation>'\"\n| fieldsAdd transactionID06 = json[metadata][originialTransactionId]\n| fieldsAdd transactionID = if(isNotNull(transactionID01), transactionID01, else:if(isNotNull(transactionID02), transactionID02, else: if(isNotNull(transactionID03), transactionID03, else: if(isNotNull(transactionID04), transactionID04, else: if(isNotNull(transactionID05), transactionID05, else: if(isNotNull(transactionID06), transactionID06))))))\n| fields timestamp, transactionID, log.file.name","timeframe":{"from":"now()-24h","to":"now()"}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}},"honeycomb":{"shape":"hexagon","legend":"auto"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}}},{"id":"1496beaf-a05e-4414-8691-8da19890bee8","type":"dql","title":"Here's what that looks like with out merging","showTitle":false,"drilldownPath":[],"showInput":true,"state":{"input":{"value":"fetch logs\n| filter matchesValue(log.source, \"/var/log/multilog/*\")\n| parse content, pattern:\"LD '<transactionid>'LD:transactionID01'</transactionid>'\"\n| parse content, \"JSON:json\"\n| fieldsAdd transactionID02 = json[transactionid]\n| parse content, pattern:\"LD ',valid,'LD:transactionID03','\"\n| parse content, pattern:\"LD 'internalizedTracking#:'LD:transactionID04','\"\n| parse content, pattern:\"LD '>PMW-'LD:transactionID05'</operation>'\"\n| fieldsAdd transactionID06 = json[metadata][originialTransactionId]\n\n| fields timestamp, transactionID01, transactionID02, transactionID03, transactionID04, transactionID05, transactionID, log.file.name","timeframe":{"from":"now()-24h","to":"now()"}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}},"honeycomb":{"shape":"hexagon","legend":"auto"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}}},{"id":"7598e0b7-724e-4831-bb39-07c82b9a231b","type":"markdown","markdown":"#### But wait! \n\nThere's another id in here which is *business critical* which hasn't been identified until now:\n**the purple monkey dishwasher ID!!**\n\nThis transaction only exists in two of the transaction logs, #2 & #6"},{"id":"92644a76-a935-4d58-aff1-d9f8e1b0c9b3","type":"dql","showTitle":false,"drilldownPath":[],"title":"Single Transaction with Purple Monkey Dishwasher ID","state":{"input":{"value":"fetch logs\n| filter matchesValue(log.source, \"/var/log/multilog/*\")\n| filter contains(content, \"20240626DYNATRANSACTION3790\")\n| parse content, pattern:\"LD '<transactionid>'LD:transactionID01'</transactionid>'\"\n| parse content, \"JSON:json\"\n| fieldsAdd transactionID02 = json[transactionid]\n| parse content, pattern:\"LD ',valid,'LD:transactionID03','\"\n| parse content, pattern:\"LD 'internalizedTracking#:'LD:transactionID04','\"\n| parse content, pattern:\"LD '>PMW-'LD:transactionID05'</operation>'\"\n| fieldsAdd transactionID06 = json[metadata][originialTransactionId]\n// added json parsing for PMDWID\n| fieldsAdd purpleMonkeyDishwasherID01 = json[metadata][purpleMonkeyDishwasherId]\n| fieldsAdd purpleMonkeyDishwasherID02 = json[purpleMonkeyDishwasherId]\n| fieldsAdd transactionID = if(isNotNull(transactionID01), transactionID01, else:if(isNotNull(transactionID02), transactionID02, else: if(isNotNull(transactionID03), transactionID03, else: if(isNotNull(transactionID04), transactionID04, else: if(isNotNull(transactionID05), transactionID05, else: if(isNotNull(transactionID06), transactionID06))))))\n| fieldsAdd purpleMonkeyDishwasherID = if(isNotNull(purpleMonkeyDishwasherID01), purpleMonkeyDishwasherID01, else:if(isNotNull(purpleMonkeyDishwasherID02), purpleMonkeyDishwasherID02))\n| fields timestamp, transactionID, purpleMonkeyDishwasherID, log.file.name\n","timeframe":{"from":"now()-24h","to":"now()"}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}},"honeycomb":{"shape":"hexagon","legend":"auto"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}}},{"id":"11d8cc53-bbad-43c2-a465-7ca707914984","type":"markdown","markdown":"#### OH! And there's revenue data which has to be tied back to the PMWID.... but it'd doesn't exist in the same records.\n#### NOT A PROBLEM WITH DQL!!!"},{"id":"941a7ff8-82e8-4085-bf0f-26c2b126250d","type":"dql","showTitle":false,"drilldownPath":[],"state":{"input":{"value":"fetch logs\n| filter matchesValue(log.source, \"/var/log/multilog/*\")\n| filter contains(content, \"20240626DYNATRANSACTION21637\")\n| parse content, pattern:\"LD '<transactionid>'LD:transactionID01'</transactionid>'\"\n| parse content, \"JSON:json\"\n| fieldsAdd transactionID02 = json[transactionid]\n| parse content, pattern:\"LD ',valid,'LD:transactionID03','\"\n| parse content, pattern:\"LD 'internalizedTracking#:'LD:transactionID04','\"\n// Added revenue from hop #4\n| parse content, pattern:\"LD 'transactionValue: 'LD:revenue','\"\n| parse content, pattern:\"LD '>PMW-'LD:transactionID05'</operation>'\"\n| fieldsAdd transactionID06 = json[metadata][originialTransactionId]\n| fieldsAdd purpleMonkeyDishwasherID01 = json[metadata][purpleMonkeyDishwasherId]\n| fieldsAdd purpleMonkeyDishwasherID02 = json[purpleMonkeyDishwasherId]\n| fieldsAdd transactionID = if(isNotNull(transactionID01), transactionID01, else:if(isNotNull(transactionID02), transactionID02, else: if(isNotNull(transactionID03), transactionID03, else: if(isNotNull(transactionID04), transactionID04, else: if(isNotNull(transactionID05), transactionID05, else: if(isNotNull(transactionID06), transactionID06))))))\n| fieldsAdd purpleMonkeyDishwasherID = if(isNotNull(purpleMonkeyDishwasherID01), purpleMonkeyDishwasherID01, else:if(isNotNull(purpleMonkeyDishwasherID02), purpleMonkeyDishwasherID02))\n| fields timestamp, transactionID, revenue, purpleMonkeyDishwasherID, log.file.name\n","timeframe":{"from":"now()-24h","to":"now()"}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}},"honeycomb":{"shape":"hexagon","legend":"auto"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}}},{"id":"d8089e44-47a7-486c-a8a3-88f5601daa27","type":"markdown","markdown":"### With DQL there are multiple ways to solve a problem. Even when a new problem arises....\n\nWhat if you want to query two different transaction ids? or transaction id & a PMDWid?"},{"id":"9af5b7c9-c3e1-46be-a4f1-089f06e6234a","type":"dql","showTitle":false,"drilldownPath":[],"state":{"input":{"value":"fetch logs\n| filter matchesValue(log.source, \"/var/log/multilog/*\") and (matchesPhrase(content, \"20240627DYNATRANSACTION9902\") or matchesPhrase(content, \"20240627DYNATRANSACTION30395\"))\n| fields timestamp, content, log.source, log.file.path","timeframe":{"from":"now()-24h","to":"now()"}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}},"honeycomb":{"shape":"hexagon","legend":"auto"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}}},{"id":"bfe5203b-adc7-4556-8c32-782a74686070","type":"dql","title":"Parsing Data with ALL possible permutations for start and end of variables","showTitle":false,"drilldownPath":[],"state":{"input":{"value":"fetch logs\n| filter matchesValue(log.source, \"/var/log/multilog/*\")\n| sort timestamp desc\n//| filter matchesValue(log.source, \"/var/log/multilog/*\") and matchesPhrase(content, \"20240627DYNATRANSACTION15566\")\n| parse content, \"\"\"DATA ('transactionid>'| 'transactionid\": \"'| 'valid,' | 'internalizedTracking#:' | 'transactionid\">PMW-' | 'originialTransactionId\": \"') LD:transactionID ('<'| '\"' | ',') \"\"\"\n| parse content, \"\"\"DATA ('DEVICE0'| ',device0'| 'hopMessage\": \"hop #' | 'hopMessage\": \"hop ' ) LD:hop ('<'| '\"' | ',') \"\"\"\n| parse content, \"\"\"DATA 'transactionValue: ' FLOAT:revenue \"\"\"\n| parse content, \"\"\" DATA 'purpleMonkeyDishwasherId\": \"' LD:purpleMonkeyDishwasherID01 '\"' \"\"\"\n\n// | parse content, \"\"\" DATA ('initationtime: '| 'external\": \"' | 'transaction initiated @ ' | 'starttime: ' | 'orininationtimestamp\": \"') TIMESTAMP('yyyy-MM-dd HH:mm:ss', timezone='UTC'):transactionTimestamp\"\"\"\n// | parse content, \"\"\" DATA ('initationtime: '| 'external\": \"' | 'transaction initiated @ ' | 'starttime: ' | 'orininationtimestamp\": \"') TIMESTAMP:transactionTimestamp2\"\"\"\n\n| fields timestamp,  purpleMonkeyDishwasherID01, transactionID, revenue, hop, content, log.file.path\n","timeframe":{"from":"now()-24h","to":"now()"}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}},"honeycomb":{"shape":"hexagon","legend":"auto"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}}},{"id":"b68d4378-12ba-4ca0-9c95-a91da4ab9b96","type":"dql","title":"Single Transactions & Network Latency for each","showTitle":false,"drilldownPath":[],"state":{"input":{"value":"fetch logs\n| filter matchesValue(log.source, \"/var/log/multilog/*\") \n| sort timestamp desc\n| parse content, \"\"\"DATA ('transactionid>'| 'transactionid\": \"'| 'valid,' | 'internalizedTracking#:' | 'transactionid\">PMW-' | 'originialTransactionId\": \"') LD:transactionID ('<'| '\"' | ',')\"\"\"\n| parse content, \"\"\"DATA ('DEVICE0'| ',device0'| 'hopMessage\": \"hop #' | 'hopMessage\": \"hop ' ) LD:hop ('<'| '\"' | ',')\"\"\"\n| parse content, \"\"\"DATA 'transactionValue: ' FLOAT:revenue \"\"\"\n| parse content, \"\"\" DATA 'purpleMonkeyDishwasherId\": \"' LD:purpleMonkeyDishwasherID01 '\"' \"\"\"\n\n| fieldsAdd hop1_timestamp = if(hop == \"1\", timestamp),\n            hop2_timestamp = if(hop == \"2\", timestamp),\n            hop3_timestamp = if(hop == \"3\", timestamp),\n            hop4_timestamp = if(hop == \"4\", timestamp),\n            hop5_timestamp = if(hop == \"5\", timestamp),\n            hop6_timestamp = if(hop == \"6\", timestamp)\n\n| summarize {transactionStart = takeLast(timestamp),\n            transactionEnd =  takeFirst(timestamp),\n            purpleMonkeyDishwasherID01 = takeAny(purpleMonkeyDishwasherID01),\n            revenue = takeAny(revenue),\n            hop1 = takeAny(hop1_timestamp),\n            hop2 = takeAny(hop2_timestamp),\n            hop3 = takeAny(hop3_timestamp),\n            hop4 = takeAny(hop4_timestamp),\n            hop5 = takeAny(hop5_timestamp),\n            hop6 = takeAny(hop6_timestamp)},\n            by:{transactionID}\n\n| fieldsAdd totalTime = transactionEnd-transactionStart,\n            hop1 = hop2-hop1,\n            hop2 = hop3-hop2,\n            hop3 = hop4-hop3,\n            hop4 = hop5-hop4,\n            hop5 = hop6-hop5\n\n| fields    transactionStart,\n            transactionEnd,\n            transctionDetails = concat(\"purpleMonkeyDishwasherID01=\",purpleMonkeyDishwasherID01,\",\",\"transactionID=\",transactionID,\",\", \"revenue=\", revenue),\n            purpleMonkeyDishwasherID01,\n            transactionID,\n            revenue,\n            totalTime,\n            hop1,\n            hop2,\n            hop3,\n            hop4,\n            hop5\n            \n| sort transactionStart desc","timeframe":{"from":"now()-30m","to":"now()"}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}},"honeycomb":{"shape":"hexagon","legend":"auto"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}}},{"id":"2f7a65b8-88f4-4391-b20f-0f182d7fa049","type":"markdown","markdown":"#### What about transactions with errors?\nAre we in a world where software works perfectly?"},{"id":"a517c305-9be1-4398-a887-cd6e66b7914b","type":"dql","showTitle":false,"drilldownPath":[],"state":{"input":{"value":"fetch logs \n| filter matchesValue(log.file.path, \"/var/log/multilog/*\")\n| filter loglevel == \"ERROR\"\n| fields timestamp, loglevel, log.file.name, content\n| sort timestamp desc","timeframe":{"from":"now()-1h","to":"now()"}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","recordField":"timestamp","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}},"honeycomb":{"shape":"hexagon","legend":"auto","dataMappings":{"category":"loglevel","value":"timestamp"}},"histogram":{"dataMappings":[]}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"visualization":"table","state":"success","result":{"code":200,"value":{"records":[{"timestamp":"2024-07-02T11:46:13.122000000-07:00","loglevel":"ERROR","log.file.name":"processor-01.log","content":"<log><timestamp>2024-07-02 18:46:13.122</timestamp><level>error</level><deviceid>DEVICE01</deviceid><transactionid>20240702DYNATRANSACTION422065350</transactionid><description>transactional record of 20240702DYNATRANSACTION422065350</description><errorcode>418</errorcode><error>418 I'm a teapot</error><metadata><operation type=\"start\">transaction initiated @ 2024-07-02 18:46:13.122</operation><operation type=\"info\">transactional record of 20240702DYNATRANSACTION422065350</operation><operation type=\"metaofthemeta\">https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/418</operation></metadata></log>"},{"timestamp":"2024-07-02T11:46:13.111000000-07:00","loglevel":"ERROR","log.file.name":"processor-01.log","content":"<log><timestamp>2024-07-02 18:46:13.111</timestamp><level>error</level><deviceid>DEVICE01</deviceid><transactionid>20240702DYNATRANSACTION50949632</transactionid><description>transactional record of 20240702DYNATRANSACTION50949632</description><errorcode>418</errorcode><error>418 I'm a teapot</error><metadata><operation type=\"start\">transaction initiated @ 2024-07-02 18:46:13.111</operation><operation type=\"info\">transactional record of 20240702DYNATRANSACTION50949632</operation><operation type=\"metaofthemeta\">https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/418</operation></metadata></log>"},{"timestamp":"2024-07-02T11:37:06.152000000-07:00","loglevel":"ERROR","log.file.name":"processor-01.log","content":"<log><timestamp>2024-07-02 18:37:06.152</timestamp><level>error</level><deviceid>DEVICE01</deviceid><transactionid>20240702DYNATRANSACTION82899320</transactionid><description>transactional record of 20240702DYNATRANSACTION82899320</description><errorcode>418</errorcode><error>418 I'm a teapot</error><metadata><operation type=\"start\">transaction initiated @ 2024-07-02 18:37:06.152</operation><operation type=\"info\">transactional record of 20240702DYNATRANSACTION82899320</operation><operation type=\"metaofthemeta\">https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/418</operation></metadata></log>"},{"timestamp":"2024-07-02T11:33:07.746000000-07:00","loglevel":"ERROR","log.file.name":"processor-01.log","content":"<log><timestamp>2024-07-02 18:33:07.746</timestamp><level>error</level><deviceid>DEVICE01</deviceid><transactionid>20240702DYNATRANSACTION939527806</transactionid><description>transactional record of 20240702DYNATRANSACTION939527806</description><errorcode>418</errorcode><error>418 I'm a teapot</error><metadata><operation type=\"start\">transaction initiated @ 2024-07-02 18:33:07.746</operation><operation type=\"info\">transactional record of 20240702DYNATRANSACTION939527806</operation><operation type=\"metaofthemeta\">https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/418</operation></metadata></log>"},{"timestamp":"2024-07-02T11:28:07.664000000-07:00","loglevel":"ERROR","log.file.name":"processor-01.log","content":"<log><timestamp>2024-07-02 18:28:07.664</timestamp><level>error</level><deviceid>DEVICE01</deviceid><transactionid>20240702DYNATRANSACTION124892977</transactionid><description>transactional record of 20240702DYNATRANSACTION124892977</description><errorcode>418</errorcode><error>418 I'm a teapot</error><metadata><operation type=\"start\">transaction initiated @ 2024-07-02 18:28:07.664</operation><operation type=\"info\">transactional record of 20240702DYNATRANSACTION124892977</operation><operation type=\"metaofthemeta\">https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/418</operation></metadata></log>"},{"timestamp":"2024-07-02T11:28:07.654000000-07:00","loglevel":"ERROR","log.file.name":"processor-01.log","content":"<log><timestamp>2024-07-02 18:28:07.654</timestamp><level>error</level><deviceid>DEVICE01</deviceid><transactionid>20240702DYNATRANSACTION595784424</transactionid><description>transactional record of 20240702DYNATRANSACTION595784424</description><errorcode>418</errorcode><error>418 I'm a teapot</error><metadata><operation type=\"start\">transaction initiated @ 2024-07-02 18:28:07.654</operation><operation type=\"info\">transactional record of 20240702DYNATRANSACTION595784424</operation><operation type=\"metaofthemeta\">https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/418</operation></metadata></log>"},{"timestamp":"2024-07-02T11:13:10.659000000-07:00","loglevel":"ERROR","log.file.name":"processor-01.log","content":"<log><timestamp>2024-07-02 18:13:10.659</timestamp><level>error</level><deviceid>DEVICE01</deviceid><transactionid>20240702DYNATRANSACTION215989296</transactionid><description>transactional record of 20240702DYNATRANSACTION215989296</description><errorcode>418</errorcode><error>418 I'm a teapot</error><metadata><operation type=\"start\">transaction initiated @ 2024-07-02 18:13:10.659</operation><operation type=\"info\">transactional record of 20240702DYNATRANSACTION215989296</operation><operation type=\"metaofthemeta\">https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/418</operation></metadata></log>"},{"timestamp":"2024-07-02T11:13:10.650000000-07:00","loglevel":"ERROR","log.file.name":"processor-01.log","content":"<log><timestamp>2024-07-02 18:13:10.650</timestamp><level>error</level><deviceid>DEVICE01</deviceid><transactionid>20240702DYNATRANSACTION74894880</transactionid><description>transactional record of 20240702DYNATRANSACTION74894880</description><errorcode>418</errorcode><error>418 I'm a teapot</error><metadata><operation type=\"start\">transaction initiated @ 2024-07-02 18:13:10.650</operation><operation type=\"info\">transactional record of 20240702DYNATRANSACTION74894880</operation><operation type=\"metaofthemeta\">https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/418</operation></metadata></log>"},{"timestamp":"2024-07-02T11:11:08.324000000-07:00","loglevel":"ERROR","log.file.name":"processor-01.log","content":"<log><timestamp>2024-07-02 18:11:08.324</timestamp><level>error</level><deviceid>DEVICE01</deviceid><transactionid>20240702DYNATRANSACTION475399305</transactionid><description>transactional record of 20240702DYNATRANSACTION475399305</description><errorcode>418</errorcode><error>418 I'm a teapot</error><metadata><operation type=\"start\">transaction initiated @ 2024-07-02 18:11:08.324</operation><operation type=\"info\">transactional record of 20240702DYNATRANSACTION475399305</operation><operation type=\"metaofthemeta\">https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/418</operation></metadata></log>"},{"timestamp":"2024-07-02T11:11:08.313000000-07:00","loglevel":"ERROR","log.file.name":"processor-01.log","content":"<log><timestamp>2024-07-02 18:11:08.313</timestamp><level>error</level><deviceid>DEVICE01</deviceid><transactionid>20240702DYNATRANSACTION170785004</transactionid><description>transactional record of 20240702DYNATRANSACTION170785004</description><errorcode>418</errorcode><error>418 I'm a teapot</error><metadata><operation type=\"start\">transaction initiated @ 2024-07-02 18:11:08.313</operation><operation type=\"info\">transactional record of 20240702DYNATRANSACTION170785004</operation><operation type=\"metaofthemeta\">https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/418</operation></metadata></log>"},{"timestamp":"2024-07-02T11:11:08.303000000-07:00","loglevel":"ERROR","log.file.name":"processor-01.log","content":"<log><timestamp>2024-07-02 18:11:08.303</timestamp><level>error</level><deviceid>DEVICE01</deviceid><transactionid>20240702DYNATRANSACTION139695684</transactionid><description>transactional record of 20240702DYNATRANSACTION139695684</description><errorcode>418</errorcode><error>418 I'm a teapot</error><metadata><operation type=\"start\">transaction initiated @ 2024-07-02 18:11:08.303</operation><operation type=\"info\">transactional record of 20240702DYNATRANSACTION139695684</operation><operation type=\"metaofthemeta\">https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/418</operation></metadata></log>"},{"timestamp":"2024-07-02T11:02:13.371000000-07:00","loglevel":"ERROR","log.file.name":"processor-01.log","content":"<log><timestamp>2024-07-02 18:02:13.371</timestamp><level>error</level><deviceid>DEVICE01</deviceid><transactionid>20240702DYNATRANSACTION512201416</transactionid><description>transactional record of 20240702DYNATRANSACTION512201416</description><errorcode>418</errorcode><error>418 I'm a teapot</error><metadata><operation type=\"start\">transaction initiated @ 2024-07-02 18:02:13.371</operation><operation type=\"info\">transactional record of 20240702DYNATRANSACTION512201416</operation><operation type=\"metaofthemeta\">https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/418</operation></metadata></log>"},{"timestamp":"2024-07-02T11:01:31.620000000-07:00","loglevel":"ERROR","log.file.name":"processor-01.log","content":"<log><timestamp>2024-07-02 18:01:31.620</timestamp><level>error</level><deviceid>DEVICE01</deviceid><transactionid>20240702DYNATRANSACTION200035064</transactionid><description>transactional record of 20240702DYNATRANSACTION200035064</description><errorcode>418</errorcode><error>418 I'm a teapot</error><metadata><operation type=\"start\">transaction initiated @ 2024-07-02 18:01:31.620</operation><operation type=\"info\">transactional record of 20240702DYNATRANSACTION200035064</operation><operation type=\"metaofthemeta\">https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/418</operation></metadata></log>"},{"timestamp":"2024-07-02T10:57:18.849000000-07:00","loglevel":"ERROR","log.file.name":"processor-01.log","content":"<log><timestamp>2024-07-02 17:57:18.849</timestamp><level>error</level><deviceid>DEVICE01</deviceid><transactionid>20240702DYNATRANSACTION174792415</transactionid><description>transactional record of 20240702DYNATRANSACTION174792415</description><errorcode>418</errorcode><error>418 I'm a teapot</error><metadata><operation type=\"start\">transaction initiated @ 2024-07-02 17:57:18.849</operation><operation type=\"info\">transactional record of 20240702DYNATRANSACTION174792415</operation><operation type=\"metaofthemeta\">https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/418</operation></metadata></log>"},{"timestamp":"2024-07-02T10:56:11.333000000-07:00","loglevel":"ERROR","log.file.name":"processor-01.log","content":"<log><timestamp>2024-07-02 17:56:11.333</timestamp><level>error</level><deviceid>DEVICE01</deviceid><transactionid>20240702DYNATRANSACTION269238297</transactionid><description>transactional record of 20240702DYNATRANSACTION269238297</description><errorcode>418</errorcode><error>418 I'm a teapot</error><metadata><operation type=\"start\">transaction initiated @ 2024-07-02 17:56:11.333</operation><operation type=\"info\">transactional record of 20240702DYNATRANSACTION269238297</operation><operation type=\"metaofthemeta\">https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/418</operation></metadata></log>"},{"timestamp":"2024-07-02T10:54:22.493000000-07:00","loglevel":"ERROR","log.file.name":"processor-01.log","content":"<log><timestamp>2024-07-02 17:54:22.493</timestamp><level>error</level><deviceid>DEVICE01</deviceid><transactionid>20240702DYNATRANSACTION233468676</transactionid><description>transactional record of 20240702DYNATRANSACTION233468676</description><errorcode>418</errorcode><error>418 I'm a teapot</error><metadata><operation type=\"start\">transaction initiated @ 2024-07-02 17:54:22.493</operation><operation type=\"info\">transactional record of 20240702DYNATRANSACTION233468676</operation><operation type=\"metaofthemeta\">https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/418</operation></metadata></log>"},{"timestamp":"2024-07-02T10:54:22.482000000-07:00","loglevel":"ERROR","log.file.name":"processor-01.log","content":"<log><timestamp>2024-07-02 17:54:22.482</timestamp><level>error</level><deviceid>DEVICE01</deviceid><transactionid>20240702DYNATRANSACTION169447080</transactionid><description>transactional record of 20240702DYNATRANSACTION169447080</description><errorcode>418</errorcode><error>418 I'm a teapot</error><metadata><operation type=\"start\">transaction initiated @ 2024-07-02 17:54:22.482</operation><operation type=\"info\">transactional record of 20240702DYNATRANSACTION169447080</operation><operation type=\"metaofthemeta\">https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/418</operation></metadata></log>"},{"timestamp":"2024-07-02T10:54:22.471000000-07:00","loglevel":"ERROR","log.file.name":"processor-01.log","content":"<log><timestamp>2024-07-02 17:54:22.471</timestamp><level>error</level><deviceid>DEVICE01</deviceid><transactionid>20240702DYNATRANSACTION382747614</transactionid><description>transactional record of 20240702DYNATRANSACTION382747614</description><errorcode>418</errorcode><error>418 I'm a teapot</error><metadata><operation type=\"start\">transaction initiated @ 2024-07-02 17:54:22.471</operation><operation type=\"info\">transactional record of 20240702DYNATRANSACTION382747614</operation><operation type=\"metaofthemeta\">https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/418</operation></metadata></log>"},{"timestamp":"2024-07-02T10:54:22.461000000-07:00","loglevel":"ERROR","log.file.name":"processor-01.log","content":"<log><timestamp>2024-07-02 17:54:22.461</timestamp><level>error</level><deviceid>DEVICE01</deviceid><transactionid>20240702DYNATRANSACTION506163746</transactionid><description>transactional record of 20240702DYNATRANSACTION506163746</description><errorcode>418</errorcode><error>418 I'm a teapot</error><metadata><operation type=\"start\">transaction initiated @ 2024-07-02 17:54:22.461</operation><operation type=\"info\">transactional record of 20240702DYNATRANSACTION506163746</operation><operation type=\"metaofthemeta\">https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/418</operation></metadata></log>"},{"timestamp":"2024-07-02T10:54:22.450000000-07:00","loglevel":"ERROR","log.file.name":"processor-01.log","content":"<log><timestamp>2024-07-02 17:54:22.450</timestamp><level>error</level><deviceid>DEVICE01</deviceid><transactionid>20240702DYNATRANSACTION690101664</transactionid><description>transactional record of 20240702DYNATRANSACTION690101664</description><errorcode>418</errorcode><error>418 I'm a teapot</error><metadata><operation type=\"start\">transaction initiated @ 2024-07-02 17:54:22.450</operation><operation type=\"info\">transactional record of 20240702DYNATRANSACTION690101664</operation><operation type=\"metaofthemeta\">https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/418</operation></metadata></log>"},{"timestamp":"2024-07-02T10:54:22.440000000-07:00","loglevel":"ERROR","log.file.name":"processor-01.log","content":"<log><timestamp>2024-07-02 17:54:22.440</timestamp><level>error</level><deviceid>DEVICE01</deviceid><transactionid>20240702DYNATRANSACTION534630807</transactionid><description>transactional record of 20240702DYNATRANSACTION534630807</description><errorcode>418</errorcode><error>418 I'm a teapot</error><metadata><operation type=\"start\">transaction initiated @ 2024-07-02 17:54:22.440</operation><operation type=\"info\">transactional record of 20240702DYNATRANSACTION534630807</operation><operation type=\"metaofthemeta\">https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/418</operation></metadata></log>"},{"timestamp":"2024-07-02T10:54:22.430000000-07:00","loglevel":"ERROR","log.file.name":"processor-01.log","content":"<log><timestamp>2024-07-02 17:54:22.430</timestamp><level>error</level><deviceid>DEVICE01</deviceid><transactionid>20240702DYNATRANSACTION88925164</transactionid><description>transactional record of 20240702DYNATRANSACTION88925164</description><errorcode>418</errorcode><error>418 I'm a teapot</error><metadata><operation type=\"start\">transaction initiated @ 2024-07-02 17:54:22.430</operation><operation type=\"info\">transactional record of 20240702DYNATRANSACTION88925164</operation><operation type=\"metaofthemeta\">https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/418</operation></metadata></log>"},{"timestamp":"2024-07-02T10:54:22.419000000-07:00","loglevel":"ERROR","log.file.name":"processor-01.log","content":"<log><timestamp>2024-07-02 17:54:22.419</timestamp><level>error</level><deviceid>DEVICE01</deviceid><transactionid>20240702DYNATRANSACTION408040149</transactionid><description>transactional record of 20240702DYNATRANSACTION408040149</description><errorcode>418</errorcode><error>418 I'm a teapot</error><metadata><operation type=\"start\">transaction initiated @ 2024-07-02 17:54:22.419</operation><operation type=\"info\">transactional record of 20240702DYNATRANSACTION408040149</operation><operation type=\"metaofthemeta\">https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/418</operation></metadata></log>"},{"timestamp":"2024-07-02T10:54:22.407000000-07:00","loglevel":"ERROR","log.file.name":"processor-01.log","content":"<log><timestamp>2024-07-02 17:54:22.407</timestamp><level>error</level><deviceid>DEVICE01</deviceid><transactionid>20240702DYNATRANSACTION531202068</transactionid><description>transactional record of 20240702DYNATRANSACTION531202068</description><errorcode>418</errorcode><error>418 I'm a teapot</error><metadata><operation type=\"start\">transaction initiated @ 2024-07-02 17:54:22.407</operation><operation type=\"info\">transactional record of 20240702DYNATRANSACTION531202068</operation><operation type=\"metaofthemeta\">https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/418</operation></metadata></log>"},{"timestamp":"2024-07-02T10:53:08.085000000-07:00","loglevel":"ERROR","log.file.name":"processor-01.log","content":"<log><timestamp>2024-07-02 17:53:08.085</timestamp><level>error</level><deviceid>DEVICE01</deviceid><transactionid>20240702DYNATRANSACTION292930110</transactionid><description>transactional record of 20240702DYNATRANSACTION292930110</description><errorcode>418</errorcode><error>418 I'm a teapot</error><metadata><operation type=\"start\">transaction initiated @ 2024-07-02 17:53:08.085</operation><operation type=\"info\">transactional record of 20240702DYNATRANSACTION292930110</operation><operation type=\"metaofthemeta\">https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/418</operation></metadata></log>"}],"metadata":{"grail":{"canonicalQuery":"fetch logs\n| filter matchesValue(log.file.path, \"/var/log/multilog/*\")\n| filter loglevel == \"ERROR\"\n| fields timestamp, loglevel, log.file.name, content\n| sort timestamp desc","timezone":"America/Los_Angeles","query":"fetch logs \n| filter matchesValue(log.file.path, \"/var/log/multilog/*\")\n| filter loglevel == \"ERROR\"\n| fields timestamp, loglevel, log.file.name, content\n| sort timestamp desc","scannedRecords":3059097,"dqlVersion":"V1_0","scannedBytes":849887778,"scannedDataPoints":0,"analysisTimeframe":{"start":"2024-07-02T17:47:31.925Z","end":"2024-07-02T18:47:31.925Z"},"locale":"und","executionTimeMilliseconds":28,"notifications":[],"queryId":"4aeb14a7-0cc3-46ab-a535-f12391c81d62","sampled":false}},"types":[{"mappings":{"timestamp":{"type":"timestamp"},"loglevel":{"type":"string"},"log.file.name":{"type":"string"},"content":{"type":"string"}},"indexRange":[0,24]}]},"notifications":[],"dateTime":"2024-07-02T18:47:32.362Z","input":{"value":"fetch logs \n| filter matchesValue(log.file.path, \"/var/log/multilog/*\")\n| filter loglevel == \"ERROR\"\n| fields timestamp, loglevel, log.file.name, content\n| sort timestamp desc","timeframe":{"from":"now()-1h","to":"now()"}}}},"title":"Logs with errors"},{"id":"e455917b-6a81-4f97-9cd9-6e640e16e3e6","type":"dql","showTitle":false,"drilldownPath":[],"state":{"input":{"value":"fetch logs \n| filter matchesValue(log.file.path, \"/var/log/multilog/processor-01.log\")\n| parse content, pattern:\"LD '<transactionid>'LD:transactionID'</transactionid>'\"\n| parse content, pattern:\"LD '<errorcode>'LD:errorcode'</errorcode>'\"\n| parse content, pattern:\"LD '<error>'LD:error'</error>'\"\n| fields timestamp, transactionID, loglevel, errorcode, error\n| sort timestamp desc","timeframe":{"from":"now()-30m","to":"now()"}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","recordField":"timestamp","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}},"honeycomb":{"shape":"hexagon","legend":"auto","dataMappings":{"category":"transactionID","value":"timestamp"}},"histogram":{"dataMappings":[]}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"visualization":"table","state":"success","result":{"code":200,"value":{"records":[{"timestamp":"2024-07-02T11:38:01.227000000-07:00","transactionID":"20240702DYNATRANSACTION503529048","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:37:06.152000000-07:00","transactionID":"20240702DYNATRANSACTION82899320","loglevel":"ERROR","errorcode":"418","error":"418 I'm a teapot"},{"timestamp":"2024-07-02T11:37:01.984000000-07:00","transactionID":"20240702DYNATRANSACTION85665664","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:36:01.457000000-07:00","transactionID":"20240702DYNATRANSACTION73618164","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:35:09.226000000-07:00","transactionID":"20240702DYNATRANSACTION471690486","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:35:01.757000000-07:00","transactionID":"20240702DYNATRANSACTION457831360","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:34:01.820000000-07:00","transactionID":"20240702DYNATRANSACTION565625538","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:33:07.746000000-07:00","transactionID":"20240702DYNATRANSACTION939527806","loglevel":"ERROR","errorcode":"418","error":"418 I'm a teapot"},{"timestamp":"2024-07-02T11:33:01.277000000-07:00","transactionID":"20240702DYNATRANSACTION49475100","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:32:07.748000000-07:00","transactionID":"20240702DYNATRANSACTION528171000","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:32:01.176000000-07:00","transactionID":"20240702DYNATRANSACTION11179313","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:31:01.952000000-07:00","transactionID":"20240702DYNATRANSACTION59303880","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:30:21.225000000-07:00","transactionID":"20240702DYNATRANSACTION34536711","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:30:16.155000000-07:00","transactionID":"20240702DYNATRANSACTION244966069","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:30:01.482000000-07:00","transactionID":"20240702DYNATRANSACTION523803590","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:29:01.743000000-07:00","transactionID":"20240702DYNATRANSACTION279125667","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:28:07.664000000-07:00","transactionID":"20240702DYNATRANSACTION124892977","loglevel":"ERROR","errorcode":"418","error":"418 I'm a teapot"},{"timestamp":"2024-07-02T11:28:07.654000000-07:00","transactionID":"20240702DYNATRANSACTION595784424","loglevel":"ERROR","errorcode":"418","error":"418 I'm a teapot"},{"timestamp":"2024-07-02T11:28:01.787000000-07:00","transactionID":"20240702DYNATRANSACTION324933748","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:27:13.948000000-07:00","transactionID":"20240702DYNATRANSACTION205156924","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:27:01.480000000-07:00","transactionID":"20240702DYNATRANSACTION109569978","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:26:27.645000000-07:00","transactionID":"20240702DYNATRANSACTION173478651","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:26:14.174000000-07:00","transactionID":"20240702DYNATRANSACTION257804382","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:26:01.803000000-07:00","transactionID":"20240702DYNATRANSACTION399911258","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:25:11.976000000-07:00","transactionID":"20240702DYNATRANSACTION9274098","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:25:01.104000000-07:00","transactionID":"20240702DYNATRANSACTION225746733","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:24:01.367000000-07:00","transactionID":"20240702DYNATRANSACTION321098544","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:23:02.037000000-07:00","transactionID":"20240702DYNATRANSACTION53371822","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:22:01.104000000-07:00","transactionID":"20240702DYNATRANSACTION77648844","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:21:10.773000000-07:00","transactionID":"20240702DYNATRANSACTION158320956","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:21:01.703000000-07:00","transactionID":"20240702DYNATRANSACTION513005908","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:20:09.066000000-07:00","transactionID":"20240702DYNATRANSACTION261243664","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:20:01.297000000-07:00","transactionID":"20240702DYNATRANSACTION12020087","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:19:12.966000000-07:00","transactionID":"20240702DYNATRANSACTION67718160","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:19:01.396000000-07:00","transactionID":"20240702DYNATRANSACTION50830392","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:18:17.664000000-07:00","transactionID":"20240702DYNATRANSACTION1044546300","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:18:07.694000000-07:00","transactionID":"20240702DYNATRANSACTION194443590","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:18:01.225000000-07:00","transactionID":"20240702DYNATRANSACTION13952574","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:17:37.100000000-07:00","transactionID":"20240702DYNATRANSACTION53777280","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:17:32.530000000-07:00","transactionID":"20240702DYNATRANSACTION541316982","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:17:20.861000000-07:00","transactionID":"20240702DYNATRANSACTION79476890","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:17:16.090000000-07:00","transactionID":"20240702DYNATRANSACTION60184445","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:17:05.920000000-07:00","transactionID":"20240702DYNATRANSACTION111855426","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:17:02.050000000-07:00","transactionID":"20240702DYNATRANSACTION259386306","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:16:43.817000000-07:00","transactionID":"20240702DYNATRANSACTION274341142","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:16:38.848000000-07:00","transactionID":"20240702DYNATRANSACTION314009478","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:16:34.879000000-07:00","transactionID":"20240702DYNATRANSACTION21830335","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:16:31.409000000-07:00","transactionID":"20240702DYNATRANSACTION65419620","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:16:19.938000000-07:00","transactionID":"20240702DYNATRANSACTION582658500","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:16:11.969000000-07:00","transactionID":"20240702DYNATRANSACTION84612192","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:16:01.700000000-07:00","transactionID":"20240702DYNATRANSACTION323829576","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:15:01.967000000-07:00","transactionID":"20240702DYNATRANSACTION101522916","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:14:01.738000000-07:00","transactionID":"20240702DYNATRANSACTION20220965","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:13:10.659000000-07:00","transactionID":"20240702DYNATRANSACTION215989296","loglevel":"ERROR","errorcode":"418","error":"418 I'm a teapot"},{"timestamp":"2024-07-02T11:13:10.650000000-07:00","transactionID":"20240702DYNATRANSACTION74894880","loglevel":"ERROR","errorcode":"418","error":"418 I'm a teapot"},{"timestamp":"2024-07-02T11:13:06.985000000-07:00","transactionID":"20240702DYNATRANSACTION499670400","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:13:02.015000000-07:00","transactionID":"20240702DYNATRANSACTION26627172","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:12:24.078000000-07:00","transactionID":"20240702DYNATRANSACTION222656064","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:12:13.810000000-07:00","transactionID":"20240702DYNATRANSACTION63853614","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:12:09.841000000-07:00","transactionID":"20240702DYNATRANSACTION936897885","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:12:05.573000000-07:00","transactionID":"20240702DYNATRANSACTION64212400","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:12:01.402000000-07:00","transactionID":"20240702DYNATRANSACTION215181099","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:11:08.324000000-07:00","transactionID":"20240702DYNATRANSACTION475399305","loglevel":"ERROR","errorcode":"418","error":"418 I'm a teapot"},{"timestamp":"2024-07-02T11:11:08.313000000-07:00","transactionID":"20240702DYNATRANSACTION170785004","loglevel":"ERROR","errorcode":"418","error":"418 I'm a teapot"},{"timestamp":"2024-07-02T11:11:08.303000000-07:00","transactionID":"20240702DYNATRANSACTION139695684","loglevel":"ERROR","errorcode":"418","error":"418 I'm a teapot"},{"timestamp":"2024-07-02T11:11:05.337000000-07:00","transactionID":"20240702DYNATRANSACTION21325356","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:11:01.067000000-07:00","transactionID":"20240702DYNATRANSACTION109958680","loglevel":"INFO","errorcode":null,"error":null},{"timestamp":"2024-07-02T11:10:01.436000000-07:00","transactionID":"20240702DYNATRANSACTION7355942","loglevel":"INFO","errorcode":null,"error":null}],"metadata":{"grail":{"canonicalQuery":"fetch logs\n| filter matchesValue(log.file.path, \"/var/log/multilog/processor-01.log\")\n| parse content, \"LD '<transactionid>'LD:transactionID'</transactionid>'\"\n| parse content, \"LD '<errorcode>'LD:errorcode'</errorcode>'\"\n| parse content, \"LD '<error>'LD:error'</error>'\"\n| fields timestamp, transactionID, loglevel, errorcode, error\n| sort timestamp desc","timezone":"America/Los_Angeles","query":"fetch logs \n| filter matchesValue(log.file.path, \"/var/log/multilog/processor-01.log\")\n| parse content, pattern:\"LD '<transactionid>'LD:transactionID'</transactionid>'\"\n| parse content, pattern:\"LD '<errorcode>'LD:errorcode'</errorcode>'\"\n| parse content, pattern:\"LD '<error>'LD:error'</error>'\"\n| fields timestamp, transactionID, loglevel, errorcode, error\n| sort timestamp desc","scannedRecords":1447909,"dqlVersion":"V1_0","scannedBytes":404188087,"scannedDataPoints":0,"analysisTimeframe":{"start":"2024-07-02T18:09:33.812Z","end":"2024-07-02T18:39:33.812Z"},"locale":"und","executionTimeMilliseconds":34,"notifications":[],"queryId":"c5609ffb-2eaf-40c3-9325-19190e6ca831","sampled":false}},"types":[{"mappings":{"timestamp":{"type":"timestamp"},"transactionID":{"type":"string"},"loglevel":{"type":"string"},"errorcode":{"type":"undefined"},"error":{"type":"undefined"}},"indexRange":[0,0]},{"mappings":{"timestamp":{"type":"timestamp"},"transactionID":{"type":"string"},"loglevel":{"type":"string"},"errorcode":{"type":"string"},"error":{"type":"string"}},"indexRange":[1,67]}]},"notifications":[],"dateTime":"2024-07-02T18:39:34.243Z","input":{"value":"fetch logs \n| filter matchesValue(log.file.path, \"/var/log/multilog/processor-01.log\")\n| parse content, pattern:\"LD '<transactionid>'LD:transactionID'</transactionid>'\"\n| parse content, pattern:\"LD '<errorcode>'LD:errorcode'</errorcode>'\"\n| parse content, pattern:\"LD '<error>'LD:error'</error>'\"\n| fields timestamp, transactionID, loglevel, errorcode, error\n| sort timestamp desc","timeframe":{"from":"now()-30m","to":"now()"}}}},"title":"XML Parsing on error fields"},{"id":"d87f737b-37eb-432c-a144-c54e3ae3b702","type":"dql","title":"Notebook Visulizations","showTitle":false,"state":{"input":{"value":"fetch logs \n| filter matchesValue(log.file.path, \"/var/log/multilog/*\")\n| fields timestamp , loglevel\n| sort timestamp desc\n| summarize count(), by: {bin(timestamp,1m), loglevel }","timeframe":{"from":"now()-1h","to":"now()"}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}},"honeycomb":{"shape":"hexagon","legend":"auto"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"drilldownPath":[]}]}